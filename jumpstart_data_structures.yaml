# SPDX-FileCopyrightText: 2023 Rivos Inc.
#
# SPDX-License-Identifier: LicenseRef-Rivos-Internal-Only

max_num_cpus_supported: 3

# Hard limits on how many pages the jumsptart infrastructure itself will occupy.
# Allows us to keep track of infrastructure code size.
# The test pages are not limited by these counts and are dependent on the
# number of pages allocated in the test memory map.
jumpstart_supervisor_text_page_counts:
  num_pages_for_all_text: 2
jumpstart_privileged_data_page_counts:
  num_pages_for_stack: 2
  num_pages_for_c_structs: 1
  num_pages_for_data_section: 1
jumpstart_umode_text_page_counts:
  num_pages_for_all_text: 1
jumpstart_umode_data_page_counts:
  num_pages_for_stack: 1
  num_pages_for_data_section: 1

rcode_start_address: 0x06000000
machine_mode_start_address: 0x7f800000

c_structs:
  thread_attributes:
    fields:
      hart_id: uint8_t
      current_mode: uint8_t
      trap_override_struct_address: uint64_t
      bookend_magic_number: uint64_t
  trap_override_attributes:
    fields:
      supervisor_mode_interrupt_handler_overrides: uint64_t,16
      supervisor_mode_exception_handler_overrides: uint64_t,16
      machine_mode_interrupt_handler_overrides: uint64_t,16
      machine_mode_exception_handler_overrides: uint64_t,16

defines:
  THREAD_ATTRIBUTES_BOOKEND_MAGIC_NUMBER_VALUE: 0x3317150533171505
  END_OF_SIM_MAGIC_ADDRESS: 0x800a0000
  UC_END_OF_SIM_MAGIC_ADDRESS: 0x42000000
  PMARR_0_MAGIC_STORE_MASK_VAL: 0x3ffffff00003
  L2CACHE_WAY_SIZE: 0x100000
  L2CACHE_NUM_WAYS: 36
  USER_MODE_ENCODING: 0
  SUPERVISOR_MODE_ENCODING: 1
  HYPERVISOR_MODE_ENCODING: 2
  MACHINE_MODE_ENCODING: 3
  MSTATUS_MPP_SHIFT: 11
  MSTATUS_SPP_SHIFT: 8
  SSTATUS_SIE_SHIFT: 1
  SATP_MODE_LSB: 60
  SATP_MODE_SV39: 8
  SATP_MODE_SV48: 9
  MENVCFG_PBMTE_BIT_LSB: 62
  MIDELEG_S_SOFT_INTERRUPT: 1
  MIDELEG_S_TIMER_INTERRUPT: 5
  MIDELEG_S_EXT_INTERRUPT: 9
  MCAUSE_INTERRUPT_BIT_LSB: 63
  MCAUSE_EC_MASK: 0x7FFFFFFFFFFFFFFFULL
  MCAUSE_EC_ILLEGAL_INSTRUCTION: 2
  MCAUSE_EC_ENV_CALL_FROM_SMODE: 9
  SCAUSE_INTERRUPT_BIT_LSB: 63
  SCAUSE_EC_MASK: 0x7FFFFFFFFFFFFFFFULL
  SCAUSE_EC_ILLEGAL_INSTRUCTION: 2
  SCAUSE_EC_ENV_CALL_FROM_UMODE: 8
  SCAUSE_INT_SOFTWARE: 1
  SCAUSE_INT_TIMER: 5
  SCAUSE_INT_EXTERNAL: 9
  SIE_EXT_INTERRUPT: 9
  PAGE_OFFSET: 12
  SOC_TB_BOOT_ADDRESS: 0x80000000
  IO_BASE: 0x11000000
  OT_UART_BASE: (IO_BASE + 0)
  OT_UART_CTRL: 0x10
  OT_UART_CTRL_TXEN: 0x01
  OT_UART_CTRL_RXEN: 0x02
  OT_UART_STATUS: 0x14
  OT_UART_STATUS_TXFULL: 0x01
  OT_UART_FIFO_STATUS: 0x24
  OT_UART_FIFO_STATUS_TXLVL_MASK: 0x3f
  OT_UART_FIFO_STATUS_RXLVL_MASK: 0x3f0000
  OT_UART_RDATA: 0x18
  OT_UART_WDATA: 0x1c
  GEILEN:             6
  IMSIC_MMIO_PAGE_SIZE: 0x1000
  IMSIC_M_BASE: 0x40007000
  IMSIC_S_BASE: 0x40000000
  IMSIC_M_INTERLEAVE: (IMSIC_MMIO_PAGE_SIZE * 8)
  IMSIC_S_INTERLEAVE: IMSIC_M_INTERLEAVE
  IMSIC_S_SIZE:       (IMSIC_MMIO_PAGE_SIZE * (GEILEN + 1))
  IMSIC_IPI_ID:       1

syscall_numbers:
  - SYSCALL_RETURN_TO_SUPERVISOR_MODE
  - SYSCALL_JUMP_TO_MACHINE_MODE_AND_EXIT

# These are the registers that need to be saved/restored when moving
# between U-mode and S-mode.
reg_context_to_save_across_umode_and_smode:
  registers:
    gprs: [sp, gp, s0, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11, t0, t1, t2, t3, t4, t5, t6, a0, a1, a2, a3, a4, a5, a6, a7, ra]
    csrs: [sepc, sstatus]
